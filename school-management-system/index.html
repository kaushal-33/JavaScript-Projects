<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Telegram Style Form</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="./assets/style.css">
</head>

<body>
    <section>
        <h6 class="text-center text-uppercase fw-bold pt-5">Admission Form</h6>
        <div class="container">
            <div class="form-container p-3 rounded mt-4">
                <form id="admissionForm">
                    <div class="d-flex gap-3">
                        <input type="number" id="grID" class="form-control text-uppercase" placeholder="GRID" required>
                        <input type="text" id="full-name" class="form-control text-uppercase" placeholder="Full name"
                            required>
                        <input type="email" id="email" class="form-control text-uppercase" placeholder="Email" required>
                        <input type="number" id="contact" class="form-control text-uppercase" placeholder="Contact"
                            required>
                    </div>
                    <button type="button" class="submit-btn btn w-100 mt-3 fw-bold" id="addBtn">Add</button>
                </form>
            </div>
            <div class="">
                <table id="dataTable" class="w-100 mt-2">
                    <thead class="">
                        <tr class="">
                            <th class="fs-5 py-2 text-uppercase ps-3">#grid</th>
                            <th class="fs-5 py-2 text-uppercase ps-3">full name</th>
                            <th class="fs-5 py-2 text-uppercase ps-3">Email</th>
                            <th class="fs-5 py-2 text-uppercase ps-3">Contact</th>
                            <th class="fs-5 py-2 text-uppercase text-end pe-3">action</th>
                        </tr>
                    </thead>
                    <tbody id="table">

                    </tbody>
                </table>
            </div>
        </div>
    </section>


    <script>
        let grID = document.getElementById("grID");
        let fullName = document.getElementById("full-name");
        let email = document.getElementById("email");
        let contact = document.getElementById("contact");
        let addBtn = document.getElementById("addBtn");
    
        class Student {
            constructor(grID, name, email, contact) {
                this.grID = grID;
                this.name = name;
                this.email = email;
                this.contact = contact;
            }
        }
    
        let school = [];
        let editIndex = null; // To track which student is being edited
    
        function renderTask() {
            let table = document.getElementById("table");
            table.innerHTML = "";
            school.forEach(function (student, index) {
                table.innerHTML += `
                    <tr>
                        <td class="border py-1 ps-3">${student.grID}</td>
                        <td class="border text-capitalize py-1 ps-3">${student.name}</td>                            
                        <td class="border py-1 ps-3">${student.email}</td>
                        <td class="border py-1 ps-3">${student.contact}</td>
                        <td class="border py-1 d-flex justify-content-end gap-3 px-3">
                            <button class="px-2 btn border-primary view-btn">View</button>
                            <button class="px-2 btn border-success edit-btn" onclick="editStudent(${index})">Edit</button>
                            <button class="px-2 btn border-danger del-btn" onclick="deleteStudent(${index})">Delete</button>
                        </td>
                    </tr>`;
            });
        }
    
        function deleteStudent(index) {
            if (confirm("Are you sure you want to delete this student?")) {
                school.splice(index, 1);
                renderTask();
            }
        }
    
        function editStudent(index) {
            // Populate form with the existing values
            grID.value = school[index].grID;
            fullName.value = school[index].name;
            email.value = school[index].email;
            contact.value = school[index].contact;
    
            // Track the student being edited
            editIndex = index;
    
            // Change button text to "Update"
            addBtn.textContent = "Update";
            addBtn.classList.remove("btn-primary");
            addBtn.classList.add("btn-warning");
        }
    
        addBtn.addEventListener("click", function () {
            if (!grID.value || !fullName.value || !email.value || !contact.value) {
                alert("Please fill out all fields before submitting.");
                return;
            }
    
            let newStudent = new Student(grID.value, fullName.value, email.value, contact.value);
    
            if (editIndex !== null) {
                // If editing, update the existing entry
                school[editIndex] = newStudent;
                editIndex = null; // Reset edit mode
                addBtn.textContent = "Add";
                addBtn.classList.remove("btn-warning");
                addBtn.classList.add("btn-primary");
            } else {
                // Otherwise, add a new student
                school.push(newStudent);
            }
    
            renderTask();
    
            // Clear form fields
            grID.value = "";
            fullName.value = "";
            email.value = "";
            contact.value = "";
        });
    
    </script>
    
</body>

</html>